This repository contains a valgrind tool to generate traces for MemViz.
It is a stripped and modified version of the CacheGrind tool.

# Setting things up 

The `setup.sh` script will clone the valgrind repository, checkout to the latest supported version (Valgrind 3.15), and add the module to it.
The script behaviour can be altered with the following nvironment variables:
    - `VG_REPO_ADDR` specifies the address of the valgrind repository. You should not modifiy this. 
    - `VG_TAG` specifies on which commit the script must checkout. Default value is the release tag of the latest supported version (`VALGRIND_3_15_0`)
    - `VG_REPO_DEST` specifies the path where the valgrind repo will be cloned. Default value is `${PWD}/valgrind`.

Once you have launched the `setup.sh` script, you can build vagrind as usual.

# Using the tool

The patched valgrind provides you the `exp-memviz` tool which record applications memory usage patterns.

For instance, let us consider the following command:

```shell
    valgrid --tool=exp-memviz --I1=65536,4,64 --D1=65536,4,64 --LL=262144,16,64 --memviz-out-file=date.mvout date
```

This invocation will record the memory traffic generated by the `date` command in the date.mvout file. 
The simulation relies on the `CacheGrind` tool.
The characteristics of the simulated L1 data cache, L1 instruction cache and last level cache can be specified respectively with the `D1`, `I1`, and `LL` arguments.
Each of those arguments is a triple (cache size, associativity, line size). 
Please note that cache and line sizes must be a power of 2.

# Coming soon

Source files annotations with phases.

# License

GPL3.0